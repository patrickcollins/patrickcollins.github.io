/* COPY ALL OF THIS INTO SCRIPT EDITOR */
/* College Comp Helper by Patrick Collins, 2014. MIT license. */
function doGet(e){onOpen(e)}function onOpen(){DocumentApp.getUi().createAddonMenu().addItem("Highlight to-be verbs","highlightToBeVerbs").addItem("Highlight prepositions (rule 3)","highlightPrepositions").addItem('Highlight "it" / "this" (rule 4)',"highlightIt").addItem('Highlight "that" / "who" (rule 5)',"highlightThatWho").addItem("View rules","openRulesSidebar").addToUi()}function highlightPrepositions(){var e=["aboard","about","above","across","after","against","along","amid","among","anti","around","as","at","before","behind","below","beneath","beside","besides","between","beyond","but","by","concerning","considering","despite","down","during","except","excepting","excluding","following","for","from","in","inside","into","like","minus","near","of","off","on","onto","opposite","outside","over","past","per","plus","regarding","round","save","since","than","through","to","toward","towards","under","underneath","unlike","until","up","upon","versus","via","with","within","without","Aboard","About","Above","Across","After","Against","Along","Amid","Among","Anti","Around","As","At","Before","Behind","Below","Beneath","Beside","Besides","Between","Beyond","But","By","Concerning","Considering","Despite","Down","During","Except","Excepting","Excluding","Following","For","From","In","Inside","Into","Like","Minus","Near","Of","Off","On","Onto","Opposite","Outside","Over","Past","Per","Plus","Regarding","Round","Save","Since","Than","Through","To","Toward","Towards","Under","Underneath","Unlike","Until","Up","Upon","Versus","Via","With","Within","Without"];var t="#82d41e";findAndHighlightWords(e,t)}function highlightToBeVerbs(){var e=["be","is","am","are","was","were","been","being","'s","'re","'m","Be","Is","Am","Are","Was","Were","Been","Being"];var t="#fc6d85";findAndHighlightWords(e,t)}function highlightIt(){var e=["it","It","this","This"];var t="#6dd8fc";findAndHighlightWords(e,t)}function highLightThatWho(){var e=["that","who","whom","That","Who","Whom"];var t="#e284fa";findAndHighlightWords(e,t)}function openRulesSidebar(){var e='<link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons.css"><ul><li>1. Use language that is descriptive, complex, and precise.</li><li>2. Do not write in the second person.</li><li>3a. Do not end sentences with prepositions.</li><li>3b. Separate introductory prepositional phrases from the sentence with a comma.</li><li>3c. Do not use multiple prepositions in a row.</li><li>4. The word "it" must have a clear antecedent.</li><li>5. Do not use the word "that" in reference to an individual; use "who" instead.</li><li>6. Do not use "I think" or similar phrases; embrace your opinions.</li><li>7. Use the oxford comma.</li><li>8. Write out the words for numbers zero through twenty.</li></ul>';var t=HtmlService.createHtmlOutput(e);t.setTitle("Rules of College Comp");DocumentApp.getUi().showSidebar(t)}function findAndHighlightWords(e,t){var n=DocumentApp.getActiveDocument().getBody().editAsText();var r=[];for(i=0;i<e.length;i++){var s=null;while(true){search=n.findText(e[i],s);if(search==null){break}else{var o=search.getElement();var u=[search.getStartOffset(),search.getEndOffsetInclusive()+1];var a=o.getText();var f=o.getText().substring(u[0],u[1]);var l=o.getText().split(" ");if(f==e[i]){for(x=0;x<l.length;x++){var c=l[x];var h=[",",".","!",";","---","â€”"];for(y=0;y<h.length;y++){if(c[c.length-1]==h[y]){c=c.substring(0,c.length-1).toLowerCase()}}if(c===e[i]){var p=a[u[0]+e[i].length];var d=a[u[0]-1];var v="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";var m=false;if(v.indexOf(d)==-1&&v.indexOf(p)==-1){m=true}if(m==true){o.setBackgroundColor(u[0],u[1]-1,t);r.push(o);break}}}}}s=search}}DocumentApp.getUi().alert("Highlighted "+r.length+" words.")}